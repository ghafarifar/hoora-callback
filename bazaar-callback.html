<!DOCTYPE html>
<html>
<head>
    <title>Redirecting to Hoora...</title>
    <meta charset="utf-8" />
    <script type="text/javascript">
        // این اسکریپت به محض بارگذاری صفحه اجرا می‌شود
        window.onload = function() {
            // ۱. پارامترهای 'code' و 'state' را از URL فعلی (URL صفحه وب) می‌خواند
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            const state = urlParams.get('state');

            // ۲. بررسی می‌کند که آیا 'code' وجود دارد یا خیر
            if (code) {
                // ۳. یک URL جدید با اسکیم سفارشی اپلیکیشن شما می‌سازد
                // و همان 'code' و 'state' را به آن اضافه می‌کند
                const appUrl = `hoora://login/callback?code=${encodeURIComponent(code)}&state=${encodeURIComponent(state || '')}`;
                
                // ۴. بلافاصله کاربر را به اپلیکیشن شما هدایت می‌کند
                window.location.href = appUrl;

                // (اختیاری) یک پیام برای کاربرانی که اپلیکیشن را ندارند نمایش می‌دهد
                document.getElementById('message').innerText = 'Trying to open the Hoora app. If it does not open, please make sure the app is installed.';

            } else {
                // اگر خطایی وجود داشته باشد، آن را نمایش می‌دهد
                const error = urlParams.get('error');
                document.getElementById('message').innerText = `An error occurred: ${error || 'Unknown error'}. Please return to the app and try again.`;
            }
        };
    </script>
</head>
<body>
    <h3 id="message">Please wait, redirecting...</h3>
</body>
</html>
